<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Student Management System</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <link rel="stylesheet" href="/stylesheets/profile.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span>StudentHub</span>
            </div>
            <ul class="nav-menu">
                <li><a href="/student/dashboard">Home</a></li>
                <li><a href="/student/profile" class="active">Profile</a></li>
                <li><a href="/student/marks">Marks</a></li>
                <li><a href="/student/attendance">Attendance</a></li>
            </ul>
            <div class="nav-user">
                <a href="/logout" class="logout-btn" title="Logout">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
                <i class="fas fa-bell"></i>
                <% if (student && student.profilepicture) { %>
                    <img src="<%= student.profilepicture %>" alt="User Avatar" class="user-avatar">
                <% } else { %>
                    <img src="/images/default-avatar.jpg" alt="User Avatar" class="user-avatar">
                <% } %>
            </div>
        </div>
    </nav>

    <!-- Success Message -->
    <% if (successMessage) { %>
    <div style="max-width: 1200px; margin: 80px auto 0; padding: 0 20px;">
        <div style="background: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 15px; border-radius: 5px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-check-circle"></i>
            <span><%= successMessage %></span>
        </div>
    </div>
    <% } %>

    <!-- Profile Header -->
    <section class="profile-header">
        <div class="container">
            <div class="profile-cover"></div>
            <div class="profile-main">
                <div class="profile-avatar-container">
                    <% if (student && student.profilepicture) { %>
                        <img src="<%= student.profilepicture %>" alt="Profile Picture" class="profile-avatar" id="profileAvatar">
                    <% } else { %>
                        <img src="/images/default-avatar.jpg" alt="Profile Picture" class="profile-avatar" id="profileAvatar">
                    <% } %>
                    <button class="avatar-edit-btn" id="editAvatarBtn">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
                <div class="profile-info">
                    <h1 id="studentName"><%= user.name %></h1>
                    <p class="student-course"><i class="fas fa-book"></i> <%= user.course %></p>
                </div>
                <div class="profile-actions" style="display: flex; gap: 15px;">
                    <button class="btn-edit" onclick="window.location.href='/student/edit-profile'">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                    <button class="btn-edit" style="background: #e53e3e;" onclick="window.location.href='/student/change-password'">
                        <i class="fas fa-key"></i> Change Password
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Profile Details -->
    <section class="profile-content">
        <div class="container">
            <div class="profile-grid">
                <!-- Personal Information -->
                <div class="profile-section">
                    <h2><i class="fas fa-user"></i> Personal Information</h2>
                    <div class="info-group">
                        <div class="info-item">
                            <label>Full Name</label>
                            <input type="text" id="fullName" value="<%= student.name || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Email</label>
                            <input type="email" id="email" value="<%= student.email || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Phone Number</label>
                            <input type="tel" id="phone" value="<%= student.phone || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Date of Birth</label>
                            <input type="date" id="dob" value="<%= student.dob ? new Date(student.dob).toISOString().split('T')[0] : '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Gender</label>
                            <select id="gender" disabled>
                                <option value="">Select Gender</option>
                                <option value="male" <%= student.gender === 'male' ? 'selected' : '' %>>Male</option>
                                <option value="female" <%= student.gender === 'female' ? 'selected' : '' %>>Female</option>
                                <option value="other" <%= student.gender === 'other' ? 'selected' : '' %>>Other</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Academic Information -->
                <div class="profile-section">
                    <h2><i class="fas fa-graduation-cap"></i> Academic Information</h2>
                    <div class="info-group">
                        <div class="info-item">
                            <label>Course</label>
                            <input type="text" id="course" value="<%= student.course || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Semester</label>
                            <input type="text" id="semester" value="<%= student.semester || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Roll Number</label>
                            <input type="text" id="rollNumber" value="<%= student.rollnumber || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Batch</label>
                            <input type="text" id="batch" value="<%= student.batch || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Section</label>
                            <input type="text" id="section" value="<%= student.section || '' %>" readonly>
                        </div>
                    </div>
                </div>

                <!-- Address -->
                <div class="profile-section">
                    <h2><i class="fas fa-address-book"></i> Address</h2>
                    <div class="info-group">
                        <div class="info-item full-width">
                            <label>Street</label>
                            <input type="text" id="street" value="<%= student.address?.street || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>City</label>
                            <input type="text" id="city" value="<%= student.address?.city || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>State</label>
                            <input type="text" id="state" value="<%= student.address?.state || '' %>" readonly>
                        </div>
                        <div class="info-item">
                            <label>Pincode</label>
                            <input type="text" id="pincode" value="<%= student.address?.pincode || '' %>" readonly>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Save Button (hidden by default) -->
            <div class="save-section" id="saveSection" style="display: none;">
                <button class="btn-cancel" id="cancelBtn">Cancel</button>
                <button class="btn-save" id="saveBtn">Save Changes</button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 StudentHub. All rights reserved.</p>
        </div>
    </footer>

    <script src="/javascripts/profile.js"></script>
</body>
</html>
